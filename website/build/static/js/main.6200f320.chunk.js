(this["webpackJsonpantd-demo"]=this["webpackJsonpantd-demo"]||[]).push([[0],{219:function(e,t,i){e.exports=i(450)},224:function(e,t,i){},296:function(e){e.exports=JSON.parse("{}")},449:function(e,t,i){},450:function(e,t,i){"use strict";i.r(t);var s={};i.r(s),i.d(s,"SetToken",(function(){return J})),i.d(s,"ApiService",(function(){return Q})),i.d(s,"setBaseUrl",(function(){return G})),i.d(s,"getBaseUrl",(function(){return X})),i.d(s,"encodeQueryData",(function(){return Y}));var a=i(0),n=i.n(a),o=i(7),r=i.n(o),l=(i(224),i(197),i(123)),c=(i(72),i(36)),d=(i(157),i(122)),m=(i(71),i(19)),h=(i(73),i(20)),g=(i(158),i(85)),u=i(109),p=i.n(u),f=(i(250),i(458)),y=i(454),w=i(453),E=i(452),b=i(464),C=i(463),k=i(451),S=(i(296),i(93)),x=i.n(S),v=(i(297),i(217)),I=i(216),L=i(21),T=i.n(L);const B={data:new Map,get(e){return e&&this.data.get(e)||null},set(e,t){if(e)return this.data.set(e,t)}};class _ extends n.a.Component{constructor(e){super(...arguments),this.connectScrollTarget=this.connectScrollTarget.bind(this),this._target=window}connectScrollTarget(e){this._target=e}restoreScrollPosition(e){e=e||this.props.scrollStore.get(this.props.scrollKey),this._target&&e&&T()(()=>{var t,i,s;t=this._target,i=e.x,s=e.y,t instanceof window.Window?t.scrollTo(i,s):(t.scrollLeft=i,t.scrollTop=s)})}saveScrollPosition(e){if(this._target){const t=function(e){if(e instanceof window.Window)return{x:e.scrollX,y:e.scrollY};return{x:e.scrollLeft,y:e.scrollTop}}(this._target);e=e||this.props.scrollKey,this.props.scrollStore.set(e,t)}}componentDidMount(){this.restoreScrollPosition()}UNSAFE_componentWillReceiveProps(e){this.props.scrollKey!==e.scrollKey&&this.saveScrollPosition()}componentDidUpdate(e){this.props.scrollKey!==e.scrollKey&&this.restoreScrollPosition()}componentWillUnmount(){this.saveScrollPosition()}render(){const e=this.props,t=e.children,i=void 0===t?null:t,s=Object(I.a)(e,["children"]);return i&&i(Object(v.a)({},s,{connectScrollTarget:this.connectScrollTarget}))}}_.defaultProps={scrollStore:B};i(101);var F=i(23),R=(i(70),i(37)),N=(i(80),i(34)),A=(i(181),i(125)),W=(i(179),i(57)),D=(i(180),i(35)),M=i(64),V=i.n(M);i(182),i(62);N.a.Meta;const j=["#f69600","#f66200","#edf600","#00f6a8","#00b9f6","#1700f6","#8b00f6","#f600e2","#f60057"];class q extends n.a.Component{constructor(e){super(e),this.state={randomColor:j[Math.floor(Math.random()*j.length)]}}render(){const e=this.props.comment;return n.a.createElement(A.a.Item,{dot:n.a.createElement("div",{style:{marginTop:5,width:10,height:10,borderRadius:5,backgroundColor:e&&e.user&&"female"==e.user.gender?"#ff8b9a":"#8baeff"}})},n.a.createElement("div",{style:{marginBottom:0}},n.a.createElement("div",{className:"custom-card",style:{width:"100%",padding:5,marginBottom:0,backgroundColor:"white",borderRadius:2}},n.a.createElement(W.a,{gutter:24},n.a.createElement(D.a,{span:24,justify:"center"},e&&e.user_alias&&n.a.createElement("div",{style:{width:"auto",marginBottom:0,backgroundColor:"white"}},n.a.createElement("span",{style:{display:"block",marginTop:0,fontSize:13,textAlign:"left",color:e&&e.user&&"female"==e.user.gender?"#ff8b9a":"#8baeff",fontWeight:500}},"@",e.user_alias)),n.a.createElement("div",{style:{width:"auto",marginBottom:0,backgroundColor:"white"}},n.a.createElement("span",{style:{display:"block",marginTop:2,marginBottom:5,fontSize:10,textAlign:"left"}},V()(e.created_at).fromNow())),n.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.html},style:{color:"rgba(0,0,0,.75)",fontSize:13,fontFamily:"Open Sans",marginLeft:0,marginTop:0,fontWeight:400}}))))))}}var P=i(459),z=i(462),O=i(201),K=i.n(O),U="https://api.friwords.com/api/v1/",H=U;function J(e){localStorage.setItem("JWT_TOKEN",e),e}function Q(e=15e3,t){t||(t={Accept:"application/json","Content-Type":"application/json"},localStorage.getItem("JWT_TOKEN")&&(t.Authorization="Bearer "+localStorage.getItem("JWT_TOKEN")));var i=p.a.create({baseURL:X(),timeout:e,headers:t});return i.interceptors.response.use(e=>e,e=>e),K()(i,{retries:5,retryDelay:e=>1e3*e}),i}function G(e){H=null==e?U:e}function X(){return H}function Y(e){let t=[];for(let i in e)t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t.join("&")}var Z={user:null,isAuthenticated:()=>null!=Z.user,register:function(e,t,i){Q().post("auth/register",e).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})},signInWithAlias:function(e,t,i){Q().post("auth/sign_in",e).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})},getMe:function(e,t){Q().get("profile/me").then(t=>{e&&e(t.data)}).catch(e=>{t&&t(e)})},updateMe:function(e,t,i){Q().post("profile/me",e).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})},generateRandomAlias:function(e,t){Q().get("auth/generate_alias").then(t=>{e&&e(t.data)}).catch(e=>{t&&t(e)})}},$=Z,ee={getFriwords:function(e,t){Q().get("friwords").then(t=>{e&&e(t.data)}).catch(e=>{t&&t(e)})},getFriwordsByFilter:function(e,t,i){Q().post("friwords/filter",e).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})},getFriwordById:function(e,t,i){let s="friwords/".concat(e);Q().get(s).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})},getPossibleMentionsByFriwordId:function(e,t,i){let s="friwords/".concat(e,"/possible_mentions");Q().get(s).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})},likeById:function(e,t,i){let s="friwords/".concat(e,"/like");Q().post(s).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})},dislikeById:function(e,t,i){let s="friwords/".concat(e,"/dislike");Q().post(s).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})},postFriword:function(e,t,i){Q().post("friwords",e).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})},postComment:function(e,t,i){let s="friwords/".concat(e.friword_id,"/comments");Q().post(s,e).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})},hasUpdatesAvailable:function(e,t,i){let s="friwords/updates_available/".concat(e);Q().get(s).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})}},te={getNotifications:function(e,t){Q().get("notifications/me").then(t=>{e&&e(t.data)}).catch(e=>{t&&t(e)})},updateNotification:function(e,t,i){let s="notifications/".concat(e.id,"/update");Q().post(s,e).then(e=>{t&&t(e.data)}).catch(e=>{i&&i(e)})}},ie=i(153);i(337);ie.initializeApp({apiKey:"AIzaSyCSAjJKGPVlX6zNOHWT2Otg2nXljs5f_lA",authDomain:"friwords-a3536.firebaseapp.com",databaseURL:"https://friwords-a3536.firebaseio.com",projectId:"friwords-a3536",storageBucket:"friwords-a3536.appspot.com",messagingSenderId:"882500991771",appId:"1:882500991771:web:f125ad3a2aa021a0eaf1be",measurementId:"G-P8SQZY3BKH"});N.a.Meta,c.a.Option;class se extends n.a.Component{constructor(e){super(e),this.getRandomAlias=()=>{this.setState({isLoading:!0}),$.generateRandomAlias(e=>{if(this.setState({isLoading:!1}),e.success){let t=this.state.auth;t.alias=e.alias,this.setState({auth:t}),this.form.setFieldsValue({alias:e.alias})}},e=>{this.setState({isLoading:!1})})},this.onFinish=()=>{this.state.auth.gender?(this.setState({isLoading:!0}),$.register({alias:this.state.auth.alias,password:this.state.auth.password,gender:this.state.auth.gender},e=>{e.success?(s.SetToken(e.token),this.props.onStart&&this.props.onStart()):h.a.open({className:"error",message:n.a.createElement(P.a,null),description:e.message}),this.setState({isLoading:!1})},e=>{this.setState({isLoading:!1})})):h.a.open({className:"error",message:n.a.createElement(P.a,null),description:"Escoge tu g\xe9nero"})},this.state={isVisible:!1,isLoading:!1,auth:{}},this.form=null}componentDidMount(){this.getRandomAlias()}render(){const e=this.state.auth;return this.props.isVisible?n.a.createElement("div",{style:{position:"absolute",top:0,left:0,width:"100%",minHeight:"100%",zIndex:99999,backgroundColor:"#25b864",paddingBottom:20}},n.a.createElement("h1",{style:{textAlign:"center",color:"white",marginTop:10}},"Ingresa a Friwords"),n.a.createElement("div",{style:{width:"100%",height:10,backgroundColor:"rgba(255,255,255,.15)",marginBottom:10,marginTop:10}}),n.a.createElement("p",{style:{maxWidth:"80%",margin:"0 auto",color:"rgba(255,255,255,.8)",textAlign:"center"}},"Crea tu alias y tu contrase\xf1a. Record\xe1 que ",n.a.createElement("b",null,"todo ser\xe1 an\xf3nimo")),n.a.createElement(F.a,{ref:e=>{this.form=e},name:"login_in",className:"login-in",initialValues:{alias:e.alias},onFinish:this.onFinish},n.a.createElement(F.a.Item,{name:"alias",rules:[{required:!0,message:"Ingresa tu alias"}],style:{width:"90%",margin:"5px auto"}},n.a.createElement(R.a,{onChange:t=>{e.alias=t.target.value,this.setState({auth:e})},style:{width:"100%",margin:"0 auto"},prefix:n.a.createElement("span",null,"@"),placeholder:"Tu alias"})),n.a.createElement("a",{onClick:this.getRandomAlias,style:{width:"90%",color:"white",textDecoration:"underline",marginLeft:"5%",margin:"0 auto",padding:0,display:"block",marginBottom:5}},"Generar alias al azar"),n.a.createElement(F.a.Item,{name:"password",rules:[{required:!0,message:"Ingresa una contrase\xf1a"}],style:{width:"90%",margin:"5px auto"}},n.a.createElement(R.a,{onChange:t=>{e.password=t.target.value,this.setState({auth:e})},type:"password",style:{width:"100%",margin:"0 auto"},prefix:n.a.createElement(z.a,{className:"site-form-item-icon"}),placeholder:"Contrase\xf1a"})),n.a.createElement("span",{style:{width:"100%",display:"block",textAlign:"center",fontWeight:600,color:"white"}},"Selecciona tu g\xe9nero"),n.a.createElement("div",{style:{width:"100%",height:40,display:"flex",flexDirection:"row",marginBottom:20}},n.a.createElement("div",{onClick:()=>{e.gender="female",this.setState({auth:e})},style:{display:"flex",flex:1,flexDirection:"row",backgroundColor:"transparent",justifyContent:"center",alignItems:"center"}},n.a.createElement("img",{style:{maxWidth:35,maxHeight:35,opacity:"female"==e.gender?1:.6},src:"https://image.flaticon.com/icons/svg/590/590083.svg"})),n.a.createElement("div",{onClick:()=>{e.gender="male",this.setState({auth:e})},style:{display:"flex",flex:1,flexDirection:"row",backgroundColor:"transparent",justifyContent:"center",alignItems:"center"}},n.a.createElement("img",{style:{maxWidth:35,maxHeight:35,opacity:"male"==e.gender?1:.6},src:"https://image.flaticon.com/icons/svg/921/921071.svg"}))),n.a.createElement(F.a.Item,{style:{display:"flex",justifyContent:"center",alignItems:"center"}},n.a.createElement(m.a,{type:"primary",htmlType:"submit",loading:this.state.isLoading,style:{display:"flex",width:"75%",margin:"0 auto",backgroundColor:"white",height:50,color:"white",fontWeight:600,justifyContent:"center",alignItems:"center",color:"#00a2ff",marginTop:15}},"Registrarme"))),n.a.createElement("div",{style:{width:"100%",height:5,backgroundColor:"rgba(255,255,255,.15)",marginBottom:10,marginTop:10}}),n.a.createElement(m.a,{onClick:()=>{this.props.onRequestLogin()},type:"primary",htmlType:"submit",loading:this.state.isLoading,style:{display:"flex",width:"100%",margin:"0 auto",height:40,color:"white",fontWeight:600,justifyContent:"center",alignItems:"center",backgroundColor:"#00a2ff"}},"\xa1Ya tengo un alias!")):null}}i(146);var ae=i(83),ne=i(461);N.a.Meta,c.a.Option;class oe extends n.a.Component{constructor(e){super(e),this.checkProps=e=>{if(e.user&&e.user.alias){let t=this.state.friword;t.user_alias=e.user.alias,this.setState({friword:t})}this.setState({isVisible:e.isVisible})},this.onFinish=()=>{this.setState({isLoading:!0}),$.signInWithAlias(this.state.auth,e=>{this.setState({isLoading:!1}),e.success?(s.SetToken(e.token),this.props.onLoggedIn(e.user)):h.a.open({className:"error",message:n.a.createElement(P.a,null),description:e.message})},e=>(this.setState({isLoading:!1}),h.a.open({className:"error",message:n.a.createElement(P.a,null),description:"Ese alias no es v\xe1lido"}),!1))},this.isValid=()=>!0,this.state={isVisible:!1,isLoading:!1,auth:{}}}componentDidMount(){this.checkProps(this.props)}componentWillReceiveProps(e){this.checkProps(e)}render(){const e=this.state.auth;return n.a.createElement(ae.a,{title:"Ingres\xe1 con tu alias",visible:this.state.isVisible,closable:!0,onCancel:()=>{this.props.onRequestClose()},footer:null},n.a.createElement(F.a,{name:"login_in",className:"login-in",onFinish:this.onFinish},n.a.createElement("div",{style:{marginBottom:10,backgroundColor:"rgba(0,0,0,.03)",padding:10}},n.a.createElement("span",null,"\xbfTienes un alias distinto? Ingresa tu alias y la contrase\xf1a que se te pidi\xf3 al crearlo.")),n.a.createElement(F.a.Item,{name:"alias",rules:[{required:!0,message:"Ingresa tu alias"}]},n.a.createElement(R.a,{onChange:t=>{e.alias=t.target.value,this.setState({auth:e})},prefix:n.a.createElement(ne.a,{className:"site-form-item-icon"}),placeholder:"Alias"})),n.a.createElement(F.a.Item,{name:"text",rules:[{required:!0,message:"Ingresa la contrase\xf1a"}]},n.a.createElement(R.a,{onChange:t=>{e.password=t.target.value,this.setState({auth:e})},type:"password",prefix:n.a.createElement(z.a,{className:"site-form-item-icon"}),placeholder:"Contrase\xf1a"})),n.a.createElement(F.a.Item,null,n.a.createElement(m.a,{type:"primary",htmlType:"submit",loading:this.state.isLoading},"Ingresar"))))}}var re=i(460);N.a.Meta,c.a.Option;const le=R.a.TextArea;class ce extends n.a.Component{constructor(e){super(e),this.checkProps=e=>{if(e.user&&e.user.alias){let t=this.state.friword;t.user_alias=e.user.alias,this.setState({friword:t})}this.setState({isVisible:e.isVisible})},this.onFinish=()=>{if(this.isValid()){this.setState({isLoading:!0});const e=this.state.friword;ee.postFriword(e,e=>{this.setState({isLoading:!1}),e.success?(this.setState({isVisible:!1,friword:{}}),this.form&&this.form.resetFields(),this.props.onCreated(e.friword)):h.a.open({className:"error",message:"Oops",description:e.message})},e=>{this.setState({isLoading:!1}),h.a.open({className:"error",message:"Oops",description:"Tu friword no pudo ser creado ahora. Intenta en unos momentos."})})}},this.isValid=()=>{const e=this.state.friword;return!(!e||!e.text||e.text.length<10)||(h.a.open({className:"error",message:"Oops",description:"Escribe un texto de al menos 10 caracteres"}),!1)},this.state={isVisible:!1,friword:{}},this.form=null}componentDidMount(){this.checkProps(this.props)}componentWillReceiveProps(e){this.checkProps(e)}render(){const e=this.state.friword;return n.a.createElement(ae.a,{title:"Publica tu friword",visible:this.state.isVisible,closable:!0,onCancel:()=>{this.props.onRequestClose()},footer:null},n.a.createElement(F.a,{ref:e=>{this.form=e},name:"post_friword",className:"post-friword",initialValues:{remember:!0},onFinish:this.onFinish},n.a.createElement("div",{style:{marginBottom:10,backgroundColor:"rgba(0,0,0,.03)",padding:10}},n.a.createElement("span",null,"\xa1Recuerda! Esto es totalmente an\xf3nimo, y tu friword aparecer\xe1 creado por ",n.a.createElement("b",null,null!=e.user_alias?e.user_alias:""))),n.a.createElement(F.a.Item,{name:"text",rules:[{required:!0,message:"Ingresa el texto"}]},n.a.createElement(le,{placeholder:"Tu texto",autoSize:{minRows:2,maxRows:8},maxLength:750,onChange:t=>{e.text=t.target.value,this.setState({friword:e})},prefix:n.a.createElement(re.a,{className:"site-form-item-icon"})})),n.a.createElement("span",null,750-(e&&e.text&&e.text.length?e.text.length:0)," caracteres restantes"),n.a.createElement("div",{style:{width:"100%",height:5,backgroundColor:"rgba(0,0,0,0.05)",marginTop:20,marginBottom:20}}),n.a.createElement(F.a.Item,null,n.a.createElement(m.a,{type:"primary",htmlType:"submit",loading:this.state.isLoading},"Publicar"))))}}i(434);var de=i(210),me=(i(436),i(127)),he=i(215);function ge(e){const t=n.a.useState(!0),i=Object(he.a)(t,2),s=i[0],a=i[1],o=n.a.useRef();return n.a.useEffect(()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>a(e.isIntersecting))});return e.observe(o.current),()=>e.unobserve(o.current)},[]),n.a.createElement("div",{className:"fade-in-section ".concat(s?"is-visible":""),ref:o},e.children)}var ue=i(457),pe=i(456),fe=i(455),ye=i(154);const we=N.a.Meta,Ee=(R.a.TextArea,me.a.Option);me.a.getMentions;class be extends n.a.Component{constructor(e){super(e),this.onDislike=()=>{this.state.hasLiked||this.state.hasDisliked||(this.props.onDislike(),this.setState({hideDislikeBtn:!0,hasDisliked:!0},()=>{setTimeout(()=>{this.setState({hideDislikeBtn:!1})},1e3)}))},this.onLike=()=>{this.state.hasLiked||this.state.hasDisliked||(this.props.onLike(),this.setState({hideLikeBtn:!0,hasLiked:!0},()=>{setTimeout(()=>{this.setState({hideLikeBtn:!1})},1e3)}))},this.state={isLoadingComments:!1,hideDislikeBtn:!1,hideLikeBtn:!1,isSendingComment:!1,canLeaveComment:!0,comment:"",showComments:!1,mentions:[],hasDisliked:!1,hasLiked:!1}}componentDidMount(){ee.getPossibleMentionsByFriwordId(this.props.friword.id,e=>{e.success&&this.setState({mentions:e.mentions})},e=>{})}render(){const e=this.props.friword,t=this.state.mentions;let i=n.a.createElement("div",{onClick:()=>{null!=this.props.user?!this.state.comment||this.state.comment.length<2?h.a.open({className:"error",message:"El comentario..",description:"A tu comentario le falta un poco de magia. Compl\xe9talo"}):(this.setState({isSendingComment:!0}),ee.postComment({text:this.state.comment,user_alias:null!=this.props.user&&null!=this.props.user.alias?this.props.user.alias:"",friword_id:e.id,likes:0,dislikes:0},e=>{this.props.onRequestComments(),this.setState({canLeaveComment:!1,isSendingComment:!1,showComments:!0}),h.a.open({className:"success",message:n.a.createElement(f.a,{twoToneColor:"#eb2f96"}),description:"Tu comentario ya est\xe1 visible"}),this.props.onPostedComment&&this.props.onPostedComment()},e=>{console.log(e)})):h.a.open({className:"error",message:"Ingresa primero",description:"Ingresa o crea tu alias para dejar comentarios"})},style:{backgroundColor:"transparent",padding:0,marginTop:0,display:"flex",flex:1}},n.a.createElement("a",{style:{fontWeight:800,padding:15}},"Enviar"));this.state.isSendingComment&&(i=n.a.createElement("div",{style:{backgroundColor:"white",padding:0,marginTop:5}},n.a.createElement(ue.a,{spin:!0,style:{color:"rgba(0,0,0,.75)"}})));e&&e.user&&e.user.gender,e&&e.user&&e.user.gender;return n.a.createElement(ge,{key:e.id},n.a.createElement("div",{className:"data-node-".concat(e.id),style:{marginBottom:20}},n.a.createElement("div",{style:{width:"100%"}},n.a.createElement("div",{style:{width:"100%",height:5,backgroundColor:"rgba(0,0,0,.025)"}}),n.a.createElement(N.a,{bordered:!1,bodyStyle:{padding:10,opacity:this.props.loading?.1:1}},n.a.createElement(we,{avatar:n.a.createElement(de.a,{src:e&&e.user&&"female"==e.user.gender?"https://image.flaticon.com/icons/svg/2284/2284897.svg":"https://image.flaticon.com/icons/svg/2284/2284900.svg",size:"large",style:{borderRadius:0,width:30,height:30}}),title:n.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},n.a.createElement("span",null,"".concat(e.text.substring(0,30),"..."))),description:n.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},n.a.createElement("span",{style:{fontSize:"0.9em"}},"".concat(e.text)))}),n.a.createElement("span",{style:{display:"block",marginTop:10,fontSize:10,textAlign:"right"}},V()(e.created_at).fromNow()),e&&e.user_alias&&n.a.createElement("span",{style:{display:"block",marginTop:0,fontSize:10,textAlign:"right"}},"por ",n.a.createElement("span",{style:{color:"#25b864",fontWeight:600}},"@",e.user_alias)),n.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"flex-start",marginTop:20,marginBottom:20}},n.a.createElement(ye.a,{color:"rgb(37, 184, 100)",duration:250,type:"rectangle",particlesAmountCoefficient:1,oscillationCoefficient:5,hidden:this.state.hideLikeBtn},n.a.createElement("div",{onClick:this.onLike,style:{display:"flex",flex:0,alignItems:"center",justifyContent:"center",backgroundColor:"#25b864",width:60,height:30,borderRadius:2,marginRight:10,cursor:"pointer",opacity:this.props.likes>0?1:.75}},n.a.createElement(pe.a,{style:{color:"white"}}),n.a.createElement("span",{style:{color:"white",marginLeft:5}},this.props.likes))),n.a.createElement(ye.a,{color:"#ff2452",duration:250,type:"rectangle",particlesAmountCoefficient:1,oscillationCoefficient:5,hidden:this.state.hideDislikeBtn},n.a.createElement("div",{onClick:this.onDislike,style:{display:"flex",flex:0,alignItems:"center",justifyContent:"center",backgroundColor:"#ff2452",width:60,height:30,borderRadius:2,cursor:"pointer",opacity:this.props.dislikes>0?1:.75}},n.a.createElement(fe.a,{style:{color:"white"}}),n.a.createElement("span",{style:{color:"white",marginLeft:5}},this.props.dislikes)))),this.state.isLoadingComments&&(!e.comments||!e.comments.length)&&n.a.createElement(k.a,{style:{fontSize:24,color:"#ff306f",marginTop:10},spin:!0}),!this.state.isLoadingComments&&!this.state.showComments&&e.comments_qty>0&&n.a.createElement("a",{onClick:()=>{this.setState({isLoadingComments:!0,showComments:!0}),this.props.onRequestComments()},style:{display:"block",marginLeft:0,marginTop:5,fontWeight:500}},"Ver ",e.comments_qty," comentarios"),null!=e.comments&&e.comments.length>0&&this.state.showComments&&n.a.createElement("a",{onClick:()=>{this.setState({isLoadingComments:!1,showComments:!1})},style:{display:"block",marginLeft:0,marginBottom:15,fontWeight:500}},"Ocultar comentarios"),n.a.createElement("div",{style:{marginLeft:5}},n.a.createElement(A.a,null,this.state.showComments&&null!=e.comments&&e.comments.length>0&&e.comments.map(e=>n.a.createElement(q,{comment:e})))),this.state.canLeaveComment&&n.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginTop:20,marginBottom:10}},n.a.createElement("div",{style:{display:"flex",flex:1}},n.a.createElement(F.a,{name:"post_comment",style:{width:"100%",paddingLeft:0,paddingRight:0,position:"relative"}},n.a.createElement(F.a.Item,{name:"comment",rules:[{required:!0,message:"Ingresa un comentario"}],style:{marginBottom:0,paddingBottom:0}},n.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"}},n.a.createElement(me.a,{onChange:e=>{this.setState({comment:e})},className:"input-comment",placeholder:"Deja tu comentario",autoSize:{minRows:1,maxRows:3},maxLength:750},t&&t.map(e=>n.a.createElement(Ee,{value:e.alias},e.alias))),i))))),null==this.props.user&&n.a.createElement("div",{style:{width:"100%",backgroundColor:"#25b864",padding:5,marginTop:10,borderRadius:2}},n.a.createElement("span",{style:{display:"block",fontSize:12,fontWeight:600,textAlign:"left",color:"white"}},"Cre\xe1 tu alias an\xf3nimo para dejar un comentario"))))))}}N.a.Meta,c.a.Option,R.a.TextArea;class Ce extends n.a.Component{constructor(e){super(e),this.checkProps=e=>{this.setState({isVisible:e.isVisible}),1==e.isVisible&&0==this.state.isVisible&&this.getNotifications()},this.getNotifications=()=>{this.setState({isLoading:!0}),te.getNotifications(e=>{if(e.success)for(var t in this.setState({notifications:e.notifications,isLoading:!1}),e.notifications)te.updateNotification({id:e.notifications[t].id,seen:!0},e=>{let i=this.state;i[t].seen=!0,this.setState({notifications:i})})},e=>{this.setState({notifications:[],isLoading:!1})})},this.onFinish=()=>{if(this.isValid()){this.setState({isLoading:!0});const e=this.state.friword;ee.postFriword(e,e=>{this.setState({isLoading:!1}),e.success?(this.setState({isVisible:!1,friword:{}}),this.form&&this.form.resetFields(),this.props.onCreated(e.friword)):h.a.open({className:"error",message:"Oops",description:e.message})},e=>{this.setState({isLoading:!1}),h.a.open({className:"error",message:"Oops",description:"Tu friword no pudo ser creado ahora. Intenta en unos momentos."})})}},this.isValid=()=>{const e=this.state.friword;return!(!e||!e.text||e.text.length<10)||(h.a.open({className:"error",message:"Oops",description:"Escribe un texto de al menos 10 caracteres"}),!1)},this.state={isVisible:!1,notifications:[]},this.form=null}componentDidMount(){this.checkProps(this.props)}componentWillReceiveProps(e){this.checkProps(e)}render(){const e=this.state,t=e.notifications,i=(e.friword,e.isLoading);return n.a.createElement(ae.a,{title:"Tus notificaciones",visible:this.state.isVisible,closable:!0,onCancel:()=>{this.props.onRequestClose()},footer:null},!i&&t&&t.length>0&&t.map(e=>n.a.createElement("div",{onClick:()=>{this.props.onClickNotification&&this.props.onClickNotification(e)},style:{width:"100%",marginBottom:10,position:"relative",backgroundColor:e.seen?"white":"rgba(255, 160, 0, .15)",padding:10,borderRadius:5}},n.a.createElement("div",{style:{width:"100%",borderBottomWidth:5,borderBottomColor:"rgba(0,0,0,.05)"},dangerouslySetInnerHTML:{__html:e.html}}),n.a.createElement("span",{style:{display:"block",width:"100%",fontSize:11,marginTop:5,textAlign:"right"}},V()(e.created_at).fromNow()),n.a.createElement("div",{style:{width:"100%",height:5,backgroundColor:"rgba(0,0,0,0.1)",marginTop:10}}))),!i&&(!t||0==t.length)&&n.a.createElement("span",null,"\xa1A\xfan no tienes notificaciones para revisar!"),i&&n.a.createElement(k.a,{style:{fontSize:24,color:"#ff306f",marginTop:10},spin:!0}))}}c.a.Option;const ke=l.a.Title,Se=g.a.TabPane;class xe extends n.a.Component{constructor(e){super(e),this.getMe=()=>{$.getMe(e=>{if(e.success&&null!=e.user&&(this.setState({user:e.user}),$.user=e.user,e.user&&!e.user.country_code&&!e.user.ip)){const e="45c816eed2d04a8b96e59ff177c609af";p.a.get("https://api.ipgeolocation.io/ipgeo?apiKey=".concat(e,"&fields=geo&output=json")).then(e=>{if(e&&e.data){const t=e.data;$.updateMe({country_name:t&&t.country_name,country_code:t&&t.country_code2,ip:t&&t.ip},e=>{e.success&&this.setState({user:e.user})})}})}})},this.getFriwords=()=>{this.setState({isLoading:!0,hasUpdates:!1}),ee.getFriwordsByFilter(this.state.filters,e=>{let t=[],i=[];for(var s in e.friwords){const a=e.friwords[s];x.a.some(this.state.friwords,e=>e.id==a.id&&e.comments&&e.comments.length>0)?t.push(new Promise((e,t)=>{ee.getFriwordById(a.id,t=>{t.success,i.push(t.friword),e()},t=>{i.push(a.friword),e()})})):i.push(a)}Promise.all(t).then(e=>{let t=x.a.orderBy(i,["created_at"],["desc"]);this.state.friwords&&this.state.friwords.length>0&&this.state.filters.page>0&&(t=this.state.friwords.concat(t)),this.setState({isLoading:!1,friwords:t})})},e=>{alert("Estamos teniendo algunos problemas en este momento. Refresca la p\xe1gina en unos segundos."),this.setState({isLoading:!1})})},this.getFriwordById=(e,t=!1)=>{ee.getFriwordById(e,i=>{if(i.success)if(t){x.a.findIndex(this.state.friwords,e=>e.id==i.friword.id);let t=[i.friword];this.setState({friwords:t,currentFriwordId:e,isLoading:!1},this.getMe)}else{let e=x.a.findIndex(this.state.friwords,e=>e.id==i.friword.id),t=this.state.friwords;t[e]=i.friword,this.setState({friwords:t,isLoading:!1})}},e=>{})},this.refresh=()=>{this.getFriwords(),this.getMe()},this.isAuthenticated=()=>$.isAuthenticated(),this.state={friwords:[],filters:{listing_mode:1,page:0},tabActiveKey:"1",isViewingNotifications:!1,isWelcome:!1,isCreating:!1,isLoggingIn:!1,isLoading:!0,hasUpdates:!1,user:null,currentFriwordId:null}}componentDidMount(){this.getFriwords(),this.getMe()}render(){const e=this.state,t=e.friwords,i=e.filters;if(this.state.isWelcome)return this.renderWelcome();const s=null!=this.state.user&&this.state.user.unread_notifications>0;return n.a.createElement("div",{className:"friwords-container"},n.a.createElement("div",{style:{width:"100%",height:45,display:"flex",flexDirection:"row",position:"fixed",top:0,right:0,display:"flex",justifyContent:"center",alignItems:"center",padding:0,backgroundColor:"white",zIndex:9999}},n.a.createElement("div",{style:{height:45,display:"flex",flexDirection:"column",flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"white",borderTopLeftRadius:0,borderBottomLeftRadius:10,cursor:"pointer",zIndex:9999,borderLeft:"2px solid rgba(0,0,0,.05)",borderBottom:"2px solid rgba(0,0,0,.05)"}},n.a.createElement("span",{style:{fontWeight:500,fontSize:"0.6em"}},this.state.user&&this.state.user.alias?"@".concat(this.state.user.alias):"-"),n.a.createElement("a",{style:{textDecorationLine:"underline",fontSize:"0.6em"},href:"#",onClick:()=>{this.isAuthenticated()?this.setState({isLoggingIn:!0}):this.setState({isWelcome:!0})}},this.isAuthenticated()?"Cambiar":"Registrar alias")),n.a.createElement("div",{className:"counter-online-users",onClick:()=>{this.isAuthenticated()?this.setState({isViewingNotifications:!0}):this.setState({isWelcome:!0})},style:{height:45,display:"flex",flex:s?1:0,justifyContent:"center",alignItems:"center",backgroundColor:s?"#fccf84":"white",borderTopLeftRadius:0,cursor:"pointer",zIndex:9999,borderLeft:"2px solid rgba(0,0,0,.05)",borderBottom:"2px solid rgba(0,0,0,.05)",paddingLeft:10,paddingRight:10}},n.a.createElement("p",{style:{fontWeight:600,margin:0,padding:0,fontSize:"0.75em"}},s?"".concat(this.state.user.unread_notifications," nueva").concat(this.state.user.unread_notifications>1?"s":""):0),n.a.createElement("img",{style:{width:20,height:20,marginLeft:5,opacity:1},src:"/img/bell-".concat(s?"on":"off",".png")})),n.a.createElement("div",{onClick:this.refresh,style:{height:45,display:"flex",flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#25b864",cursor:"pointer",zIndex:9999,borderBottomRightRadius:10,borderLeft:"0px solid rgba(0,0,0,.05)",borderBottom:"2px solid rgba(0,0,0,.2)",opacity:this.state.hasUpdates?1:.6}},n.a.createElement("span",{style:{fontWeight:500,fontSize:"0.6em",color:"white"}},this.state.isLoading?"Actualizando..":"Actualizar"),n.a.createElement("img",{style:{width:30,height:30,marginLeft:10},src:"https://image.flaticon.com/icons/svg/1688/1688988.svg"}))),n.a.createElement("section",{style:{textAlign:"center",marginTop:80,marginBottom:20}},n.a.createElement(ke,{level:2,className:"Title"},"Friwords")),n.a.createElement("div",{className:"scroll-container"},n.a.createElement(Ce,{isVisible:this.state.isViewingNotifications,user:this.state.user,onRequestClose:()=>{this.setState({isViewingNotifications:!1},this.getMe)},onClickNotification:e=>{null!=e.redirect_to&&e.redirect_to.indexOf("friword/")>-1&&(this.setState({isLoading:!0,isViewingNotifications:!1}),this.getFriwordById(e.redirect_to.replace("friword/",""),!0))}}),n.a.createElement(oe,{isVisible:this.state.isLoggingIn,onRequestClose:()=>{this.setState({isLoggingIn:!1})},onLoggedIn:e=>{this.setState({user:e,isLoggingIn:!1},this.refresh)}}),n.a.createElement(ce,{isVisible:this.state.isCreating,onRequestClose:()=>{this.setState({isCreating:!1})},user:this.state.user,onCreated:e=>{this.setState({isCreating:!1}),i.page=0,i.listing_mode=1,this.setState({filters:i,tabActiveKey:"1"},this.refresh),h.a.open({className:"success",message:n.a.createElement(f.a,{twoToneColor:"#eb2f96"}),description:"Tu friword fue publicado exitosamente en la secci\xf3n `Recientes`"})}}),null!=this.state.currentFriwordId&&[n.a.createElement("div",{style:{width:"100%",flexDirection:"row",justifyContent:"center",alignItems:"center"}},n.a.createElement(m.a,{onClick:()=>{this.setState({currentFriwordId:null},this.refresh)},type:"primary",icon:n.a.createElement(y.a,null),style:{display:"flex",width:"80%",margin:"0 auto",marginBottom:20,justifyContent:"center",alignItems:"center",height:40}},"Volver atr\xe1s")),n.a.createElement(be,{loading:this.state.isLoading,friword:this.state.friwords[0],comments:this.state.friwords[0].comments,likes:this.state.friwords[0].likes_qty,dislikes:this.state.friwords[0].dislikes_qty,commentsQty:this.state.friwords[0].comments_qty,user:this.state.user,onLike:()=>{ee.likeById(this.state.friwords[0].id,e=>{setTimeout(()=>{this.getFriwordById(this.state.friwords[0].id,!0),this.getMe()},500)})},onDislike:()=>{ee.dislikeById(this.state.friwords[0].id,e=>{setTimeout(()=>{this.getFriwordById(this.state.friwords[0].id,!0),this.getMe()},500)})},onRequestComments:()=>{this.getFriwordById(this.state.friwords[0].id,!0)},onPostedComment:this.getMe})],null==this.state.currentFriwordId&&[n.a.createElement("div",{style:{width:"100%",flexDirection:"row",justifyContent:"center",alignItems:"center"}},n.a.createElement(m.a,{disabled:null==this.state.user,onClick:()=>{this.isAuthenticated()?this.setState({isCreating:!0}):this.setState({isWelcome:!0})},type:"primary",icon:n.a.createElement(w.a,null),style:{display:"flex",width:"80%",margin:"0 auto",justifyContent:"center",alignItems:"center",height:40}},"Publicar friword")),null==this.state.user&&n.a.createElement("a",{onClick:()=>{this.setState({isWelcome:!0})},style:{display:"block",textAlign:"center",marginTop:15,fontWeight:600,marginRight:0,textDecoration:"underline"}},"Registr\xe1 un alias para comentar y publicar nuevos Friwords"),n.a.createElement(g.a,{style:{marginTop:20},activeKey:this.state.tabActiveKey,type:"card",onTabClick:e=>{2==e?(i.only_me=!0,i.page=0):(i.only_me=!1,i.listing_mode=e,i.page=0),this.setState({filters:i,tabActiveKey:e},this.getFriwords)},defaultActiveKey:"1"},n.a.createElement(Se,{tab:n.a.createElement("span",null,n.a.createElement(E.a,null),"M\xe1s destacados"),key:"0"},t&&t.map((e,t)=>n.a.createElement(be,{loading:this.state.isLoading,friword:e,comments:e.comments,likes:e.likes_qty,dislikes:e.dislikes_qty,commentsQty:e.comments_qty,user:this.state.user,onLike:()=>{ee.likeById(e.id,t=>{setTimeout(()=>{this.getFriwordById(e.id),this.getMe()},500)})},onDislike:()=>{ee.dislikeById(e.id,t=>{setTimeout(()=>{this.getFriwordById(e.id),this.getMe()},500)})},onRequestComments:()=>{this.getFriwordById(e.id)},onPostedComment:this.getMe})),n.a.createElement(m.a,{onClick:()=>{i.page+=1,this.setState({filters:i},this.getFriwords)},loading:this.state.isLoading,type:"primary",icon:n.a.createElement(b.a,null),style:{display:"flex",width:"80%",margin:"0 auto",marginBottom:20,justifyContent:"center",alignItems:"center",height:40}},"Cargar m\xe1s")),n.a.createElement(Se,{tab:n.a.createElement("span",null,n.a.createElement(C.a,null),"Recientes"),key:"1"},t&&t.map((e,t)=>n.a.createElement(be,{loading:this.state.isLoading,friword:e,comments:e.comments,likes:e.likes_qty,dislikes:e.dislikes_qty,commentsQty:e.comments_qty,user:this.state.user,onLike:()=>{ee.likeById(e.id,t=>{setTimeout(()=>{this.getFriwordById(e.id)},500)})},onDislike:()=>{ee.dislikeById(e.id,t=>{setTimeout(()=>{this.getFriwordById(e.id)},500)})},onRequestComments:()=>{this.getFriwordById(e.id)},onPostedComment:this.getMe})),n.a.createElement(m.a,{onClick:()=>{i.page+=1,this.setState({filters:i},this.getFriwords)},type:"primary",icon:n.a.createElement(b.a,null),loading:this.state.isLoading,style:{display:"flex",width:"80%",margin:"0 auto",marginBottom:20,justifyContent:"center",alignItems:"center",height:40}},"Cargar m\xe1s")),n.a.createElement(Se,{tab:n.a.createElement("span",null,n.a.createElement(C.a,null),"M\xedos"),key:"2"},t&&t.map((e,t)=>n.a.createElement(be,{loading:this.state.isLoading,friword:e,comments:e.comments,likes:e.likes_qty,dislikes:e.dislikes_qty,commentsQty:e.comments_qty,user:this.state.user,onLike:()=>{ee.likeById(e.id,t=>{setTimeout(()=>{this.getFriwordById(e.id)},500)})},onDislike:()=>{ee.dislikeById(e.id,t=>{setTimeout(()=>{this.getFriwordById(e.id)},500)})},onRequestComments:()=>{this.getFriwordById(e.id)},onPostedComment:this.getMe})),n.a.createElement(m.a,{onClick:()=>{i.page+=1,this.setState({filters:i},this.getFriwords)},type:"primary",loading:this.state.isLoading,icon:n.a.createElement(b.a,null),style:{display:"flex",width:"80%",margin:"0 auto",marginBottom:20,justifyContent:"center",alignItems:"center",height:40}},"Cargar m\xe1s")))],this.state.isLoading&&n.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"}},n.a.createElement(d.a,{indicator:n.a.createElement(k.a,{style:{fontSize:24},spin:!0})}))))}renderWelcome(){return n.a.createElement("div",{className:"friwords-container"},n.a.createElement(se,{isVisible:this.state.isWelcome,onStart:()=>{this.setState({isWelcome:!1},this.getMe),h.a.open({className:"success",message:n.a.createElement(f.a,{twoToneColor:"#eb2f96"}),description:"Bienvenid@ a Friwords. Empieza leyendo y publicando"}),setTimeout(()=>{this.getFriwords()},3e3)},onRequestLogin:()=>{this.setState({isLoggingIn:!0,isWelcome:!1})}}))}}i(449);c.a.Option,l.a.Title;var ve=()=>n.a.createElement(xe,null);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(ve,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})},62:function(e,t,i){}},[[219,1,2]]]);
//# sourceMappingURL=main.6200f320.chunk.js.map